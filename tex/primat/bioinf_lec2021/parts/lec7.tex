\documentclass[main.tex]{subfiles}
\begin{document}

\section{Лекция 7а. Сборка геномов de novo}

Вирусные и бактериальные геномы (3-5 kbp) несравнимы с геномом человека (3.2 млн пар).
У растений геном ещё раз в 40 длиннее, чем у человека.

Сборка генома \emph{de novo} теми методами,

Если у нас есть референс (<<среднее по больнице>>), мы просто картируем последовательность на геном.
Если его нет, ставится задача сборки \emph{de novo}.

Для сборки должно быть покрытие прочтениями порядка 40 ex (каждый нуклеотид прочитан не менее 40 раз в среднем). % TODO ask: как это определить?

\subsubsection{Алгоритмы сборки генома}

Из неупорядоченного набора коротких последовательностей надо собрать как можно более длинный \emph{контиг} (contig) -- непрерывный фрагмент ДНК.

Scaffold -- последовательность упорядоченных контигов (для них известен порядок и на каком расстоянии они находятся друг от друга). % TODO ask: как мы узнаем порядок и расстояние в геноме DeNovo?

\subsubsection{Сложности при сборке}
Сложная структура (повторы, полиплоидность у растений...)
\begin{leftbar}
    Все высшие организмы -- древние полиплоиды, т. е. у них количество генетического материала когда-то удвоилось.
    Но это было давно и сейчас незаметно.
\end{leftbar}

\subsection{Алгоритмы сборки генома}

\subsubsection{Наименьшая общая надстрока}

Цель -- найти для множества строк $ S $ минимальную строку $ w $, содержащую все данные.

Тривиальный вариант: $ w = \cup_i s_i $

\subsubsection{Граф перекрытий}
При поиске надстроки надо найти гамильтонов цикл в графе перекрытий.

\subsubsection{Графы де Брёйна}

В узлах графа де Брёйна строки длины $ k -1 $, а на рёбрах -- длины $ k $.

Здесь надо искать наименьший путь по рёбрам (эйлеров путь), и эта задача может быть решена за полиномиальное время.
Но при этом мы теряем часть информации, поэтому в реальности ищут не путь,а \emph{суперпуть} -- наименьший путь, содержащий все пути Эйлера.
Это NP-трудная задача.

% TODO жадные и эвристические алгоритмы

\subsubsection{Сборка на графах}

После сборки генома нужно упрощать граф (искать и устранять ошибки секвенирования, распутывать сложные участки).
Результат -- контиги.

Этот процесс основан на \emph{ графах перекрытий } (в узлах контиги, ребро проводится, если есть перекрытие ).
Раньше графы

\subsubsection{ Вычисление перекрытий }

% TODO

\subsubsection{Упрощение графов перекрытий}

Используются жадные алгоритмы и потоковые алгоритмы.

Удаление отростков, разрешение развилок, ...
Для решения этих задач есть отдельные модули.

\subsubsection{Сборщики}

Есть основанные на графе перекрытий (старые) и на графах де Брюйна.
ABySS -- есть распределённая версия, что хорошо.

SPAdes -- был разработан в Академическом университете в лаборатории Павла Певзнера (когда она там ещё была).
Один из лучших.

Разные сборщики лучше работают на разных данных.

\subsubsection{Оценка качества сборки}

Обычно контигом считается фрагмент длины >50 баз.

Критерии качества:
\begin{enumerate}[noitemsep]
    \item Total Length: если > длины генома,
    \item \% GC
    \item NXY (N с двузначным числом, например, N50): важный параметр.
    $ N50 = 4000 $ означает, что $50\%$ всех контигов длины 4000 покрывают хотя бы половину собранного генома.
    \item NGXY -- если есть референс, можно посчитать такую же статистику
    \item ...
\end{enumerate}

На прак

\section{Лекция 7б. Анализ данных ChipSeq }

В ядре находятся ДНК, связанные с белками.
\subsubsection{Протокол ChipSeq}
\begin{enumerate}[noitemsep]
    \item Производится сшивка ДНК с белками, которые с ней контактируют (сшитые фрагменты называются хроматином).
    \item Хроматин выделяем из ядра и режем ультразвуком на фрагменты определённой длины.
    \item Добавляем антитела к исследуемому белку (например, транскрипционному фактору).
    Это позволяет выделить только те фрагменты, которые содержат транскрипционный фактор (часто антитела ковалентно пришиты к \emph{бусинам} -- beads).
    \item Разрушаем комплекс ДНК-белок и выделяем чистую ДНК.
\end{enumerate}

Выделенная ДНК -- это, вероятно, фрагменты длиннее, чем нужные нам сайты посадки <<белка интереса>> (например, сайт посадки ТФ), но выделенный генетический материал обогащён этими сайтами.

Далее секвенируем ДНК (готовим библиотеку, читаем сканером и собираем геном на референс).

Фрагмент ДНК, связанный с белком-гистоном, -- $ \approx 140 $ нуклеотидов.
Сайт посадки ТФ -- $ \approx 10-20 $ нуклеотидов.

Если в покрытии референса прочитанной ДНК есть пик, это может быть сайт посадки ТФ, но может быть и шум, вызванный, например, тем, что участки со свободным хроматином (без белков-гистонов)

\subsubsection{Препроцессинг пиков}

% TODO some

Кажется, что можно описать пики распределением Пуассона, но не всё так просто.

\subsubsection{ Схема эксперимента с негативным контролем }

Можем использовать либо неспецифичные антитела (не к нашему белку, а к другому) и повторить операцию.
Или повторить все операции вовсе без использования антител.
Посмотреть, как меняется картина пиков.
Считается, что потенциальные ложноположительные пики есть и в эксперименте, и в контроле.

Какие неспецифичные антитела можно использовать?
К примеру, иммуноглобулины.

\subsubsection{Корректировка обогащённости с учётом контроля}

Посчитали количество фрагментов в пике.
Эти фрагменты могут соответствовать либо фоновым, либо ложноположительным пикам, и их надо отсечь.
Отсечение делаем с помощью нормализации (убираем фон, для чего пытаемся понять в опыте и контроле, где фон и где не фон); обычно используют эмпирические соображения: там, где мало фрагментов, там фон.

Для оценки статистической значимости используют разницу опыта и контроля: разность или fold change (во сколько раз одно больше другого).

Скорректированные с учётом контроля значения обогащённости могут быть сами по себе оценкой статистической значимости, или можно использовать FDR (False Detection Rate): поделить датасет на два... % TODO

\subsubsection{Пример: подсчёт числа ложно-положительных пиков в пакете GLITR}

Строим график: зависимость обогащённости (высоты пика) от относительной обогащённости (fold change)...

\subsubsection{Работа с репликатами в ChipSeq}

Можно объединять прочтения от репликатов.

\subsubsection{ Проверка идентифицированных пиков }

Биоинформатика что-то предсказывает, а затем надо доказать.
Можно пос


Делим

\subsubsection{}

\begin{enumerate}[noitemsep]
    \item
    \item
\end{enumerate}

\end{document}
